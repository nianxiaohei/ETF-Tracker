# ETF 价格跟踪系统 - 快速启动指南

## 📋 前置条件

- macOS 系统（已安装 Python 3.9+）
- 网络连接（用于访问雪球网站）

## 🚀 快速启动（两种方式）

### 方式一：使用启动脚本（最简单）⭐

```bash
# 进入项目目录
cd /Users/nianxiaohei/Desktop/ETF_trace

# 运行启动脚本
./start.sh
```

启动脚本会自动：
- 检查并创建虚拟环境（如果需要）
- 检查并安装依赖（如果需要）
- 显示菜单，选择你要执行的操作

### 方式二：手动启动（3步）

#### 第1步：安装依赖

```bash
# 进入项目目录
cd /Users/nianxiaohei/Desktop/ETF_trace

# 激活虚拟环境（如果已创建）
source venv/bin/activate

# 如果没有虚拟环境，先创建并安装依赖
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

#### 第2步：测试运行

```bash
# 获取当前价格（最简单的方式）
python main.py price
```

如果看到价格信息，说明程序运行正常！

#### 第3步：开始使用

**方式一：完整分析（推荐首次使用）**

```bash
python main.py analyze
```

程序会：
1. 自动获取当前 ETF 价格
2. 提示你输入上次交易价格和数量
3. 分析盈亏情况
4. 给出操作建议

**方式二：指定参数分析**

```bash
python main.py analyze --price 2.08 --quantity 10000
```

## 📖 常用命令

### 1. 获取当前价格
```bash
python main.py price
```

### 2. 分析 ETF（交互式）
```bash
python main.py analyze
```

### 3. 分析 ETF（指定参数）
```bash
python main.py analyze --price 2.08 --quantity 10000
```

### 4. 获取并保存价格
```bash
python main.py fetch
```

### 5. 查看价格历史
```bash
python main.py history
# 或查看最近30天
python main.py history --days 30
```

### 6. 查看交易记录
```bash
python main.py list
```

### 7. 查看帮助
```bash
python main.py --help
python main.py analyze --help
```

## ⚙️ 配置说明

### 默认配置

程序默认跟踪 **SZ159915（创业板ETF易方达）**

### 更换 ETF 标的

**方法1：在命令中指定**
```bash
python main.py analyze --code SH510300 --price 3.5 --quantity 5000
```

**方法2：创建 .env 文件（可选）**

在项目根目录创建 `.env` 文件：
```bash
ETF_CODE=SH510300
ETF_NAME=沪深300ETF
DATA_DIR=./data
LOG_DIR=./logs
```

## 🔄 定时任务（可选）

如果你想每天自动采集价格，可以配置 macOS 定时任务：

### 1. 修改定时任务配置文件

编辑 `com.etf.tracker.plist` 文件，修改以下路径：
- Python 路径（使用 `which python3` 查看）
- 项目路径（当前是 `/Users/nianxiaohei/Desktop/ETF_trace`）
- 日志路径

### 2. 加载定时任务

```bash
# 复制配置文件到系统目录
cp com.etf.tracker.plist ~/Library/LaunchAgents/

# 加载任务
launchctl load ~/Library/LaunchAgents/com.etf.tracker.plist

# 立即测试运行
launchctl start com.etf.tracker

# 查看任务状态
launchctl list | grep etf.tracker
```

## 💡 使用示例

### 场景1：第一次使用

```bash
# 1. 激活虚拟环境
source venv/bin/activate

# 2. 获取当前价格，看看程序是否正常
python main.py price

# 3. 进行完整分析
python main.py analyze
# 然后按提示输入你的交易价格和数量
```

### 场景2：日常查看

```bash
# 每天运行一次，查看当前价格和盈亏
python main.py analyze --price 2.08 --quantity 10000
```

### 场景3：查看历史趋势

```bash
# 查看最近7天的价格历史
python main.py history

# 查看最近30天的价格历史
python main.py history --days 30
```

## ❓ 常见问题

### Q1: 提示 "ModuleNotFoundError"
**解决**：需要先安装依赖
```bash
source venv/bin/activate
pip install -r requirements.txt
```

### Q2: 获取价格失败
**可能原因**：
- 网络连接问题
- 雪球网站访问限制
- ETF 代码错误

**解决**：
- 检查网络连接
- 确认 ETF 代码正确（如 SZ159915）
- 查看日志文件 `logs/app.log`

### Q3: 如何更换 ETF？
**方法**：在命令中使用 `--code` 参数
```bash
python main.py analyze --code SH510300
```

## 📁 数据文件位置

所有数据保存在 `data/` 目录：
- `price_history.csv` - 价格历史
- `user_transactions.csv` - 交易记录
- `alert_status.csv` - 提醒状态
- `alert_history.csv` - 提醒历史

日志文件保存在 `logs/` 目录：
- `app.log` - 应用日志
- `error.log` - 错误日志

## 🎯 下一步

1. ✅ 完成依赖安装
2. ✅ 测试 `python main.py price` 获取价格
3. ✅ 运行 `python main.py analyze` 进行首次分析
4. ⏭️ （可选）配置定时任务自动采集

---

**提示**：更多详细信息请查看 `README.md` 文件
